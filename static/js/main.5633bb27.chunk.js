(this.webpackJsonpnerai=this.webpackJsonpnerai||[]).push([[0],{11:function(e,t,r){},16:function(e,t,r){"use strict";r.r(t);var n=r(1),s=r.n(n),c=r(3),i=r.n(c),o=(r(11),r(2)),a=r(18);const l=(e,t)=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)),u=e=>Math.PI/180*e,d=(e,t)=>{const r=Object(n.useRef)({values:t,handler:function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e(...n,r.current.values)}});return r.current.values=t,r.current.handler},h=["gray","green","blue","purple","gold"],b=e=>({tier:e,effects:[]}),j=e=>{const t=(e=>{const t=[90,9,1,0,0];for(let r=1;r<=e;r++){let e=2;r>9?e=4:r>4&&(e=3);let n=0;for(let r=e;r>0;r--)t[r]+=1,n+=t[r];const s=100-n;t[0]=s}return t})(e),r=l(0,101);let n=0,s=0;for(let c=0;c<t.length;c++)if(n+=t[c],r<n){s=c;break}return{tier:s,effects:[]}},g=["baseTargets","extraSpawnOnHit","multiOnHit","multiOnConsecutiveHit"],p={baseTargets:{descriptions:["Increases base number of targets by 1","Increases base number of targets by 2","Increases base number of targets by 3","Increases base number of targets by 4"]},extraSpawnOnHit:{descriptions:["5% chance of extra target spawning on hit","10% chance of extra target spawning on hit","15% chance of extra target spawning on hit","20% chance of extra target spawning on hit"]},multiOnHit:{descriptions:["Not implemented yet. Do not choose"]},multiOnConsecutiveHit:{descriptions:["Not implemented yet. Do not choose"]}},x=g.reduce(((e,t)=>(e[t]=0,e)),{}),O=e=>{let{level:t,name:r}=e;return p[r].descriptions[t]},m=[b(0),b(0),b(0)];var v=r(0);const y=o.a.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 80px;
  background-color: #333;
  color: white;
  padding: 12px 24px 24px;
  display: flex;
  h1 {
    margin-right: 48px;
  }
`;var f=e=>{let{timeRemaining:t}=e;const{state:r}=Object(n.useContext)(B),s=Object.entries(r.upgrades).filter((e=>{let[t,r]=e;return r>0})).map((e=>{let[t,r]=e;return O({name:t,level:r})})).join(", ");return Object(v.jsxs)(y,{children:[Object(v.jsxs)("h1",{children:["Level ",r.level]}),Object(v.jsxs)("h1",{children:["Current Score: ",r.currentScore," / ",r.goalScore]}),Object(v.jsxs)("h1",{children:["Time Left: ",t]}),Object(v.jsxs)("p",{children:["Upgrades: ",s]})]})};const S=o.a.div`
  height: 100%;
  width: 100%;
`;var w=()=>{const{state:e,dispatch:t}=Object(n.useContext)(B),r=Object(n.useRef)(null),[s,c]=Object(n.useState)(),[i,o]=Object(n.useState)(),[b,g]=Object(n.useState)(),p=Object(n.useRef)({x:500,y:500}),x=Object(n.useRef)([]),O=Object(n.useRef)(e);Object(n.useEffect)((()=>{O.current=e}),[e]),Object(n.useEffect)((()=>{const e=r.current;c(e);const t=r.current.getContext("2d");o(t),r.current.width=window.innerWidth,r.current.height=window.innerHeight,e.requestPointerLock({unadjustedMovement:!0});const n=()=>k(e),s=()=>m(e);return document.addEventListener("pointerlockchange",n,!1),document.addEventListener("click",s),()=>{document.removeEventListener("pointerlockchange",n),document.removeEventListener("click",s),document.exitPointerLock()}}),[]),Object(n.useEffect)((()=>{let e;return s&&i&&(e=a.a(C)),()=>e&&e.stop()}),[s,i]);const m=n=>{if(document.pointerLockElement){const r=p.current.x,n=p.current.y;let c;const i=x.current.filter((e=>{let{x:t,y:s,radius:i,target:o}=e;const a=Math.sqrt(Math.pow(t-r,2)+Math.pow(s-n,2))>=i+5;return a||(c=o),a}));if(c){const{extraSpawnOnHit:r}=e.upgrades;r>0&&(s=.05*r,Math.random()<s)&&(i.push(y()),i.push(y())),t({type:"hitTarget",payload:{inc:c.tier+1}}),x.current=i}else t({type:"hitTarget",payload:{inc:-1}})}else setTimeout((()=>{r.current.requestPointerLock({unadjustedMovement:!0})}),100);var s},y=()=>{if(!r.current)throw new Error("Cannot spawn new target with no canvas");const{targetSize:t,level:n}=e,{width:s,height:c}=r.current;return{x:l(s/2-s/4,s-t-s/2),y:l(c/2-c/4,c-t-c/2),radius:t,target:j(n)}},w=(e,t)=>{const{width:r,height:n}=e;t.fillStyle="white",t.fillRect(0,0,r,n),(e=>{x.current.forEach((t=>{let{x:r,y:n,radius:s,target:c}=t;e.fillStyle=h[c.tier],e.beginPath(),e.arc(r,n,s,0,u(360),!0),e.fill(),e.closePath()}))})(t),t.fillStyle="#f00",t.beginPath(),t.arc(p.current.x,p.current.y,5,0,u(360),!0),t.fill(),t.closePath()},C=d(((r,n)=>{let[s,c]=n;if(!s||!c)return;(t=>{const{baseTargets:r}=e.upgrades,n=x.current.length;if(n<=r&&t){for(let e=n;e<r;e++)x.current.push(y());x.current.push(y())}})(s),w(s,c);const i=(e.timer-r/1e3).toFixed(2);if(i<=0)return t({type:"endRound"});g(i)}),[s,i]),k=e=>{document.pointerLockElement===e||document.mozPointerLockElement===e?e.addEventListener("mousemove",E,!1):e.removeEventListener("mousemove",E,!1)},E=d(((t,r)=>{let[n,s]=r;if(!s)return;const{x:c,y:i}=n.current;if(c>s.width)return void(n.current={x:s.width-1,y:i});if(i>s.height)return void(n.current={x:c,y:s.height-1});if(c<0)return void(n.current={x:1,y:i});if(i<0)return void(n.current={x:c,y:1});const o=t.movementX*(e.sensitivity||1),a=t.movementY*(e.sensitivity||1);n.current={x:c+o,y:i+a}}),[p,s]);return Object(v.jsxs)(S,{children:[Object(v.jsx)(f,{timeRemaining:b}),Object(v.jsx)("canvas",{ref:r})]})};const C=o.a.div`
  background-color: black;
  opacity: .4;
  height: 100vh;
  width: 100vw;
  z-index: 1;
  position: fixed;
  top: 0;
  left: 0;
`,k=o.a.div`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 2;
  background-color: white;
  padding: 24px;
  border-radius: 4px;
  opacity: 1;
`,E=e=>{let{children:t,close:r}=e;return Object(v.jsx)(v.Fragment,{children:Object(c.createPortal)(Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(k,{children:t}),Object(v.jsx)(C,{onClick:r})]}),document.body)})},I=o.a.div`
  padding: 4px;
  border: 3px solid #eee;
  border-radius: 4px;
`,L=e=>{let{tier:t}=e;return Object(v.jsx)(I,{style:{borderColor:h[t]},children:"N/A"})},P=o.a.div`
  padding: 4px;
  border: 3px solid #eee;
  border-radius: 4px;
  cursor: pointer;
  hover {
    opacity: .6;
  }
`,R=e=>{let{title:t,description:r,onClick:n,selected:s}=e;return Object(v.jsxs)(P,{style:{borderColor:"#eee",borderWidth:s?"5px":"3px",fontWeight:s?"bold":"normal"},onClick:n,children:[t,Object(v.jsx)("br",{}),r]})},N=o.a.div`
`,T=()=>{const[e,t]=Object(n.useState)(),{state:r,dispatch:s}=Object(n.useContext)(B);return Object(v.jsxs)(N,{children:[Object(v.jsx)("h1",{children:"Shop"}),"Current Gold: ",r.money,Object(v.jsx)("br",{}),"Current Deck:",Object(v.jsx)("div",{style:{display:"flex"},children:r.targets.map(((e,t)=>{let{tier:r}=e;return Object(v.jsx)(L,{tier:r},t+r)}))}),Object(v.jsx)("button",{onClick:()=>{t((e=>{let{count:t}=e;const r=[];for(;r.length<t;){const e=g[l(0,g.length)];r.includes(e)||r.push(e)}return r})({count:3}))},children:"Purchase Card"}),Object(v.jsx)("button",{disabled:r.money<30,children:"Remove Card (200 gold)"}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:()=>s({type:"startNextRound"}),children:"Next Level"}),Object(v.jsx)(z,{options:e,close:()=>t()})]})},z=e=>{let{options:t,close:r}=e;const{state:s,dispatch:c}=Object(n.useContext)(B),[i,o]=Object(n.useState)(0);return t?Object(v.jsxs)(E,{close:()=>{},children:[Object(v.jsx)("h1",{children:"Choose Your Card"}),t.map(((e,t)=>{const r=s.upgrades[e];return Object(v.jsx)(R,{title:"Level "+r,description:O({level:r,name:e}),onClick:()=>o(t),selected:i===t},t)})),Object(v.jsx)("button",{onClick:()=>{c({type:"upgrade",payload:{upgrades:[t[i]]}}),r()},children:"Collect"})]}):Object(v.jsx)(v.Fragment,{})},M={sensitivity:.4,targetSize:8},H=(e,t)=>localStorage.setItem(e,t),F=e=>{let{isOpen:t,close:r}=e;const{state:s,dispatch:c}=Object(n.useContext)(B);return Object(n.useEffect)((()=>{const{sensitivity:e,targetSize:t}=s;e&&H("sensitivity",e),t&&H("targetSize",t)}),[s.sensitivity,s.targetSize]),t?Object(v.jsxs)(E,{close:r,children:[Object(v.jsx)("h1",{children:"Settings"}),Object(v.jsxs)("div",{children:["Sensitivity: \xa0",Object(v.jsx)("input",{type:"number",step:"0.01",value:s.sensitivity,onChange:e=>c({type:"changeSettings",payload:{sensitivity:e.target.value}})})]}),Object(v.jsxs)("div",{children:["Target Size (in px): \xa0",Object(v.jsx)("input",{type:"number",step:"1",value:s.targetSize,onChange:e=>c({type:"changeSettings",payload:{targetSize:e.target.value}})})]}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:r,children:"Save"})]}):Object(v.jsx)(v.Fragment,{})},G={status:"INITIAL",sensitivity:(A="sensitivity",localStorage.getItem(A)||M[A]),targetSize:(e=>parseInt(localStorage.getItem(e)||M[e]))("targetSize")};var A;const D={timer:20,currentScore:0,goalScore:10,level:1,money:0,targets:m,upgrades:x},U=e=>({...e,money:e.money+e.currentScore,currentScore:0,level:e.level+1,goalScore:Math.ceil(1.2*e.goalScore),status:"SHOP"}),q=(e,t)=>{switch(t.type){case"changeSettings":return{...e,sensitivity:t.payload.sensitivity||e.sensitivity,targetSize:t.payload.targetSize||e.targetSize};case"returnToHomeScreen":return{status:"INITIAL"};case"startGame":return{...e,status:"RUNNING",...D};case"hitTarget":const r=e.currentScore+t.payload.inc;return r>=e.goalScore?U(e):{...e,currentScore:r};case"endRound":return e.currentScore>=e.goalScore?U(e):{...e,status:"COMPLETED"};case"upgrade":if("SHOP"===!e.status)throw new Error("Must be in shop to purchase");const n=Object.assign({},e.upgrades);return t.payload.upgrades.forEach((e=>n[e]++)),{...e,upgrades:n};case"startNextRound":if("SHOP"===!e.status)throw new Error("Must be in shop to begin next round");return{...e,status:"RUNNING",timer:20};default:throw new Error("Action not recognized - "+t.type)}},W=o.a.div`
`,B=s.a.createContext();var J=()=>{const[e,t]=Object(n.useReducer)(q,G),[r,s]=Object(n.useState)(!1),c=()=>{t({type:"startGame"})};return Object(v.jsx)(B.Provider,{value:{state:e,dispatch:t},children:Object(v.jsxs)(W,{children:["INITIAL"===e.status&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("button",{onClick:c,children:"Start Game"}),Object(v.jsx)("button",{onClick:()=>s(!0),children:"Settings"}),Object(v.jsx)(F,{isOpen:r,close:()=>s(!1)})]}),"RUNNING"===e.status&&Object(v.jsx)(w,{}),"SHOP"===e.status&&Object(v.jsx)(T,{}),"COMPLETED"===e.status&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("h1",{children:"Game Over"}),"Score Reached: ",e.currentScore,"Goal Score: ",e.goalScore,Object(v.jsx)("button",{onClick:c,children:"Play Again"}),Object(v.jsx)("button",{onClick:()=>{t({type:"returnToHomeScreen"})},children:"Return Home"})]})]})})};var Y=e=>{e&&e instanceof Function&&r.e(3).then(r.bind(null,19)).then((t=>{let{getCLS:r,getFID:n,getFCP:s,getLCP:c,getTTFB:i}=t;r(e),n(e),s(e),c(e),i(e)}))};i.a.render(Object(v.jsx)(s.a.StrictMode,{children:Object(v.jsx)(J,{})}),document.getElementById("root")),Y()}},[[16,1,2]]]);
//# sourceMappingURL=main.5633bb27.chunk.js.map